<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">screwdriver | Aergia</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://qubitpi.github.io/aergia/blog/2022/06/30/screwdriver"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="screwdriver | Aergia"><meta data-rh="true" name="description" content="[//]: # (Copyright Jiaqi Liu)"><meta data-rh="true" property="og:description" content="[//]: # (Copyright Jiaqi Liu)"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-06-30T00:00:00.000Z"><link data-rh="true" rel="icon" href="/aergia/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://qubitpi.github.io/aergia/blog/2022/06/30/screwdriver"><link data-rh="true" rel="alternate" href="https://qubitpi.github.io/aergia/blog/2022/06/30/screwdriver" hreflang="en"><link data-rh="true" rel="alternate" href="https://qubitpi.github.io/aergia/blog/2022/06/30/screwdriver" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/aergia/blog/rss.xml" title="Aergia RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/aergia/blog/atom.xml" title="Aergia Atom Feed"><link rel="stylesheet" href="/aergia/assets/css/styles.7e16a810.css">
<link rel="preload" href="/aergia/assets/js/runtime~main.0da343a9.js" as="script">
<link rel="preload" href="/aergia/assets/js/main.ca32b199.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/aergia/"><div class="navbar__logo"><img src="/aergia/img/logo.png" alt="Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/aergia/img/logo.png" alt="Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Aergia</b></a><a class="navbar__item navbar__link" href="/aergia/docs/intro">Recipes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/aergia/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/QubitPi/aergia" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Enterprise IaC</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/11/07/iac-intro">iac-intro</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/11/06/chef-intro">chef-intro</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/11/05/ruby">ruby</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/10/31/jenkins-on-aws">jenkins-on-aws</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/10/30/jenkins-touble-shooting">jenkins-touble-shooting</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/09/30/nexus">nexus</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/08/31/continuous-delivery">continuous-delivery</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/07/31/docker-c-advisor">docker-c-advisor</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/aergia/blog/2022/06/30/screwdriver">screwdriver</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/aergia/blog/2022/05/27/openvpn">openvpn</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">screwdriver</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-06-30T00:00:00.000Z" itemprop="datePublished">June 30, 2022</time> · <!-- -->5 min read</div></header><div id="post-content" class="markdown" itemprop="articleBody"><hr><p>slug: screwdriver
title: Open Sourcing Screwdriver - Yahoo&#x27;s Continuous Delivery Build System for Dynamic Infrastructure
authors: <!-- -->[jiaqi]</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tags-cicd">tags: <!-- -->[CI/CD]<a class="hash-link" href="#tags-cicd" title="Direct link to heading">​</a></h2><p>Continuous Delivery enables software development teams to move faster and adapt to users&#x27; needs quicker by reducing the
inherent friction associated with releasing software changes. Yahoo&#x27;s engineering has modernized as it has embraced
Continuous Delivery as a strategy for improving product quality and engineering agility. All our active products deliver
from commit to production with full automation and this has greatly improved Yahoo&#x27;s ability to deliver products.</p><p>Part of what enabled Yahoo to make Continuous Delivery at scale a reality was our improved build and release tooling.
Now, we are open sourcing an adaptation of our code as <a href="http://screwdriver.cd/" target="_blank" rel="noopener noreferrer">Screwdriver.cd</a>, a new streamlined build
system designed to enable Continuous Delivery to production at scale for dynamic infrastructure.</p><p>Some of the key design features of Screwdriver have helped Yahoo achieve Continuous Delivery at scale. At a high level
these are:</p><ul><li>Making deployment pipelines easy</li><li>Optimizing for trunk development</li><li>Making rolling back easy</li></ul><p><strong>Easy deployment pipelines</strong>: Deployment pipelines that continuously test, integrate, and deploy code to production
greatly reduce the risk of errors and reduce the time to get feedback to developers. The challenge for many groups had
been that pipelines were cumbersome to setup and maintain. We designed a solution that made pipelines easy to configure
and completely self-service for any developer. By managing the pipeline configuration in the code repository Screwdriver
allows developers to configure pipelines in a manner familiar to them, and as a bonus, to easily code review pipeline
changes too.</p><p><strong>Trunk development</strong>: Internally, we encourage workflows where the trunk is always shippable. Our teams use a modified
<a href="https://guides.github.com/introduction/flow/" target="_blank" rel="noopener noreferrer">GitHub flow</a> for their workflows. Pull Requests (PRs) are the entry point
for running tests and ensuring code that entered the repository has been sufficiently tested. Insisting on formal PRs
also improves the quality of our code reviews.</p><p>To ensure trunks are shippable, we enable functional testing of code in the PRs. Internally, this is a configuration
baked into pipelines that dynamically allocates compute resources, deploys the code, and runs tests. These tests include
web testing using tools like Selenium. These dynamically-allocated resources are also available for a period after the
PR build, allowing engineers to interact with the system and review visual aspects of their changes.</p><p><strong>Easy rollbacks</strong>: To allow for easy code rollbacks, we allow phases of the pipeline to be re-run at a previously-saved
state. We leverage features in our PaaS to handle the deployment, but we store and pass metadata to enable us to re-run
from a specific git SHA with the same deployment data. This allows us to roll back to a previous state in production.
This design makes rolling back as easy as selecting a version from a dropdown menu and clicking &quot;deploy&quot;. Anyone with
write access to the project can make this change. This helped us move teams to a DevOps model where developers were
responsible for the production state.</p><p>The successful growth of Screwdriver over the past 5 years at Yahoo has today led to Screwdriver being synonymous with
Continuous Delivery within the company. <strong>Screwdriver handles over 25,000+ builds per day and 12,000+ daily git commits
as a single shared entrypoint for Yahoo. It supports multiple languages and handles both virtual machine and
container-based builds and deployment</strong>.</p><p><img loading="lazy" alt="Error screwdriver-example.png" src="/aergia/assets/images/screwdriver-example-1ff653cddcc8400a79122dc09a0e65b2.png" width="1264" height="694" class="img_ev3q"></p><p>Screwdriver.cd&#x27;s architecture is comprised of four main components: a frontend for serving content to the user, a
stateless API that orchestrates between user interactions and build operations, the execution engines (Docker Swarm,
Kubernetes, etc.) that checkout source code and execute in containers, and the launcher that executes and monitors
commands inside the container.</p><p>The diagram below shows this architecture overlaid with a typical developer flow.</p><p><img loading="lazy" alt="Error sd-workflow.png" src="/aergia/assets/images/sd-workflow-d933e04661ecbdef9646361e5fc60ca6.png" width="1920" height="900" class="img_ev3q"></p><p>To give some context around our execution engines, internal Screwdriver started as an abstraction layer on top of
Jenkins and used Docker to provide isolation, common build containers, etc. We used features provided by Jenkins plugins
to leverage existing work around coverage and test reports. However, as Screwdriver usage continued to climb, it outgrew
a single Jenkins cluster. So in order to grow to our needs, we added capabilities in Screwdriver that allowed us to
scale horizontally while also adding capabilities to schedule pipelines across a number of Jenkins clusters. As we
scaled Screwdriver, we used less from Jenkins and built more supporting services utilizing our cloud infrastructure. The
open-source version is focused on Kubernetes and Docker Swarm as our primary supported execution engines.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col margin-top--sm"><a href="https://github.com/QubitPi/aergia/tree/gh-pages/blog/2022-06-30-screwdriver/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/aergia/blog/2022/07/31/docker-c-advisor"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">docker-c-advisor</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/aergia/blog/2022/05/27/openvpn"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">openvpn</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tags-cicd" class="table-of-contents__link toc-highlight">tags: CI/CD</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/aergia/docs/category/recipes">Recipes</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/aergia" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/aergia/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/QubitPi/aergia" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Jiaqi Liu. Built with Docusaurus.</div></div></div></footer></div>
<script src="/aergia/assets/js/runtime~main.0da343a9.js"></script>
<script src="/aergia/assets/js/main.ca32b199.js"></script>
</body>
</html>