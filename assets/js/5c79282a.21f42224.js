"use strict";(self.webpackChunkhashicorp_aws=self.webpackChunkhashicorp_aws||[]).push([[3421],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(n),h=i,u=m["".concat(l,".").concat(h)]||m[h]||d[h]||o;return n?a.createElement(u,r(r({ref:t},p),{},{components:n})):a.createElement(u,r({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var c=2;c<o;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8037:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=n(7462),i=(n(7294),n(3905));const o={slug:"jenkins-on-aws",title:"Deploying Jenkins to AWS",authors:["jiaqi"],tags:["Jenkins"],date:new Date("2022-10-31T00:00:00.000Z")},r=void 0,s={permalink:"/hashicorp-aws/blog/jenkins-on-aws",editUrl:"https://github.com/QubitPi/hashicorp-aws/tree/gh-pages/blog/jenkins-on-aws/index.md",source:"@site/blog/jenkins-on-aws/index.md",title:"Deploying Jenkins to AWS",description:"[//]: # (Copyright Jiaqi Liu)",date:"2022-10-31T00:00:00.000Z",formattedDate:"October 31, 2022",tags:[{label:"Jenkins",permalink:"/hashicorp-aws/blog/tags/jenkins"}],readingTime:45.915,hasTruncateMarker:!0,authors:[{name:"Jiaqi Liu",title:"Maintainer of hashicorp-aws",url:"https://github.com/QubitPi",imageURL:"https://avatars.githubusercontent.com/u/16126939?v=4",key:"jiaqi"}],frontMatter:{slug:"jenkins-on-aws",title:"Deploying Jenkins to AWS",authors:["jiaqi"],tags:["Jenkins"],date:"2022-10-31T00:00:00.000Z"},prevItem:{title:"SSL through Certbot",permalink:"/hashicorp-aws/blog/certbot"},nextItem:{title:"Nexus 3 Repository Manager OSS",permalink:"/hashicorp-aws/blog/nexus"}},l={authorsImageUrls:[void 0]},c=[{value:"Creating a Key Pair",id:"creating-a-key-pair",level:2},{value:"Creating a Security Group",id:"creating-a-security-group",level:2},{value:"Launching an Amazon EC2 Instance",id:"launching-an-amazon-ec2-instance",level:2},{value:"Installing Jenkins on EC2",id:"installing-jenkins-on-ec2",level:2},{value:"Connecting to Our Linux Instance",id:"connecting-to-our-linux-instance",level:3},{value:"Downloading and Installing Jenkins",id:"downloading-and-installing-jenkins",level:3},{value:"Installing Java",id:"installing-java",level:4},{value:"Installing Jenkins",id:"installing-jenkins",level:4},{value:"Long Term Support Release",id:"long-term-support-release",level:5},{value:"Weekly Release",id:"weekly-release",level:5},{value:"Enable SSL on Jenkins Server (Ubuntu)",id:"enable-ssl-on-jenkins-server-ubuntu",level:2},{value:"Resources",id:"resources",level:3},{value:"Local System Resources",id:"local-system-resources",level:4},{value:"WWW Resources",id:"www-resources",level:4},{value:"About OpenSSL",id:"about-openssl",level:3},{value:"About X.509",id:"about-x509",level:4},{value:"Installing OpenSSL Toolkit",id:"installing-openssl-toolkit",level:3},{value:"Generating SSL Certificates",id:"generating-ssl-certificates",level:3},{value:"Self-signing a Certificate",id:"self-signing-a-certificate",level:4},{value:"Establishing a Certificate Authority",id:"establishing-a-certificate-authority",level:5},{value:"Creating a Self-Signed Server Certificate",id:"creating-a-self-signed-server-certificate",level:5},{value:"Signing the Self-Signed Server Certificate",id:"signing-the-self-signed-server-certificate",level:5},{value:"Chrome: Bypass &quot;Your connection is not private&quot; Message",id:"chrome-bypass-your-connection-is-not-private-message",level:5},{value:"Applying for a Certificate using Certbot",id:"applying-for-a-certificate-using-certbot",level:4},{value:"Install and Setup Certbot",id:"install-and-setup-certbot",level:5},{value:"Convert SSL keys to PKCS12 format",id:"convert-ssl-keys-to-pkcs12-format",level:4},{value:"Convert PKCS12 to JKS format",id:"convert-pkcs12-to-jks-format",level:4},{value:"Add JKS to Jenkins Path",id:"add-jks-to-jenkins-path",level:4},{value:"Modify Jenkins Configuration for SSL",id:"modify-jenkins-configuration-for-ssl",level:4},{value:"Restart Jenkins",id:"restart-jenkins",level:4},{value:"HTTPS via Nginx Reverse Proxy",id:"https-via-nginx-reverse-proxy",level:4},{value:"Understanding the Nginx Configuration File Structure and Configuration Contexts",id:"understanding-the-nginx-configuration-file-structure-and-configuration-contexts",level:5},{value:"The Main Context",id:"the-main-context",level:6},{value:"The Events Context",id:"the-events-context",level:6},{value:"The HTTP Context",id:"the-http-context",level:6},{value:"The Server Context",id:"the-server-context",level:6},{value:"The Location Context",id:"the-location-context",level:6},{value:"How Certbot + Nginx Enable SSL",id:"how-certbot--nginx-enable-ssl",level:5},{value:"Post-Installation Setup Wizard",id:"post-installation-setup-wizard",level:3},{value:"Unlocking Jenkins",id:"unlocking-jenkins",level:4},{value:"Customizing Jenkins with Plugins",id:"customizing-jenkins-with-plugins",level:4},{value:"Creating the First Administrator User",id:"creating-the-first-administrator-user",level:4},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Docker Permission Error When Trigger by Jenkins",id:"docker-permission-error-when-trigger-by-jenkins",level:3},{value:"Echo Off in Jenkins Console Output",id:"echo-off-in-jenkins-console-output",level:3}],p={toc:c};function d(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,a.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Jenkins is an open-source automation server that integrates with a number of AWS Services, including: AWS CodeCommit,\nAWS CodeDeploy, Amazon EC2 Spot, and Amazon EC2 Fleet. We can use Amazon Elastic Compute Cloud (Amazon EC2) to deploy a\nJenkins application on AWS."),(0,i.kt)("p",null,"This section documents the process of deploying a Jenkins application. We will launch an EC2 instance, install Jenkins\non that instance, and configure Jenkins to automatically spin up Jenkins agents if build abilities need to be augmented\non the instance."),(0,i.kt)("admonition",{title:"Prerequisites",type:"note"},(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://portal.aws.amazon.com/billing/signup#/start"},"Register an AWS account"),", if not having one yet."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#creating-a-key-pair"},"An Amazon EC2 key pair"),", if we don't have one yet"))),(0,i.kt)("h2",{id:"creating-a-key-pair"},"Creating a Key Pair"),(0,i.kt)("p",null,"Creating a key pair helps ensure that the correct form of authentication is used when we install Jenkins."),(0,i.kt)("p",null,"To create our key pair:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/ec2/"},"Amazon EC2 console")," and sign in.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the navigation pane, under ",(0,i.kt)("strong",{parentName:"p"},"NETWORK & SECURITY"),", select ",(0,i.kt)("strong",{parentName:"p"},"Key Pairs"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Create key pair"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"For ",(0,i.kt)("strong",{parentName:"p"},"Name"),", enter a descriptive name for the key pair. Amazon EC2 associates the public key with the name that we\nspecify as the ",(0,i.kt)("strong",{parentName:"p"},"key name"),". A key name can include up to 255 ASCII characters. It cannot include leading or trailing\nspaces.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"For ",(0,i.kt)("strong",{parentName:"p"},"File format"),", select the format in which to save the private key."),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"For OpenSSH compatibility (Linux or Mac OS X), select pem."),(0,i.kt)("li",{parentName:"ul"},"For PuTTY compatibility (Windows), select ppk."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("strong",{parentName:"p"},"Create key pair"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"The private key file downloads automatically. The base file name is the name we specified as the name of our key\npair, and the file name extension is determined by the file format we chose. Save the private key file in a safe\nplace."),(0,i.kt)("admonition",{parentName:"li",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This is the only chance for us to save the private key file."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If we use an SSH client on a macOS or Linux computer to connect to our Linux instance, we would also run the\nfollowing command to set the permissions of our private key file so that only we can read it, otherwise we won't be\nable to connect to our instance using this key pair. For more information, please refer to\n",(0,i.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/TroubleshootingInstancesConnecting.html#troubleshoot-unprotected-key"},"Error: Unprotected private key file"),"."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"chmod 400 <key_pair_name>.pem\n")))),(0,i.kt)("h2",{id:"creating-a-security-group"},"Creating a Security Group"),(0,i.kt)("p",null,"A security group acts as a firewall that controls the traffic allowed to reach one or more EC2 instances. When we launch\nan instance, we can assign it one or more security groups. We add rules that control the traffic allowed to reach the\ninstances in each security group. We can modify a security group's rules any time, and the new rules take effect\n",(0,i.kt)("em",{parentName:"p"},"immediately"),"."),(0,i.kt)("p",null,"To create and configure our security group:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Decide who may access our instance. For example, a single computer or all trusted computers on a network. For a\nsingle computer/user, we can use the public IP address of the computer/user. To find the IP address, use the\n",(0,i.kt)("a",{parentName:"p",href:"http://checkip.amazonaws.com/"},"check IP service tool"),' from AWS3 (this tool works for VPN as well) or search for the\nphrase "what is my IP address" in any search engine.')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Sign in to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/ec2/"},"AWS Management Console"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the Amazon EC2 console by selecting ",(0,i.kt)("strong",{parentName:"p"},"EC2")," under ",(0,i.kt)("strong",{parentName:"p"},"Compute"),"."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"Error loading ec2-service.png",src:n(8238).Z,width:"1828",height:"841"}))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the left-hand navigation bar, select ",(0,i.kt)("strong",{parentName:"p"},"Security Groups"),", and then select ",(0,i.kt)("strong",{parentName:"p"},"Create Security Group"),"."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"Error loading create-security-group.png",src:n(6561).Z,width:"1852",height:"625"}))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In ",(0,i.kt)("strong",{parentName:"p"},"Security group name"),", enter ",(0,i.kt)("strong",{parentName:"p"},"WebServerSG")," or any preferred name of our choice, and provide a description.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select our VPC from the list. We can use the default VPC.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the ",(0,i.kt)("strong",{parentName:"p"},"Inbound tab"),", add the rules as follows:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Add Rule"),", and then select ",(0,i.kt)("strong",{parentName:"li"},"SSH")," from the Type list."),(0,i.kt)("li",{parentName:"ul"},"Under Source, select ",(0,i.kt)("strong",{parentName:"li"},"Custom"),", and in the text box, enter the IP address from step 1."),(0,i.kt)("li",{parentName:"ul"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Add Rule"),", and then select ",(0,i.kt)("strong",{parentName:"li"},"HTTP")," from the Type list."),(0,i.kt)("li",{parentName:"ul"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Add Rule"),", and then select ",(0,i.kt)("strong",{parentName:"li"},"Custom TCP Rule")," from the Type list."),(0,i.kt)("li",{parentName:"ul"},"Under ",(0,i.kt)("strong",{parentName:"li"},"Port Range"),", enter ",(0,i.kt)("strong",{parentName:"li"},"8080")," (Jenkins UI port)."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select Create."))),(0,i.kt)("p",null,"For more information, refer to\n",(0,i.kt)("a",{parentName:"p",href:"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html"},"Security Groups")," in the Amazon EC2 User\nGuide for Linux Instances."),(0,i.kt)("h2",{id:"launching-an-amazon-ec2-instance"},"Launching an Amazon EC2 Instance"),(0,i.kt)("p",null,"To launch an EC2 instance:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Sign in to the ",(0,i.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/ec2/"},"AWS Management Console"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the Amazon EC2 console by selecting EC2 under ",(0,i.kt)("strong",{parentName:"p"},"Compute"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"From the Amazon EC2 dashboard, select ",(0,i.kt)("strong",{parentName:"p"},"Launch Instance"),"."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"Error loading ec2-launch-instance.png",src:n(370).Z,width:"1867",height:"856"}))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'We will run Ubuntu OS in our instance, so let\'s pick up "Ubuntu" and give it a name such as "Jenkins Server"'),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"Error loading ec2-instance-setup.png",src:n(7764).Z,width:"1590",height:"1210"}))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the Choose an Instance Type page, the ",(0,i.kt)("strong",{parentName:"p"},"t2.micro")," instance is selected by default. Verify this instance type is\nselected to stay within the free tier.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Pick up the Key Pair (under "Key pair" section) and the security group (under "Network settings") we defined\npreviously')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Hit "Launch Instance"')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the left-hand navigation bar, choose Instances to view the status of our instance. Initially, the status of our\ninstance is pending. After the status changes to running, our instance is ready for use."),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"Error loading ec2-view-created-instance.png",src:n(7259).Z,width:"1864",height:"633"})))),(0,i.kt)("h2",{id:"installing-jenkins-on-ec2"},"Installing Jenkins on EC2"),(0,i.kt)("p",null,"Now that the Amazon EC2 instance has been launched, Jenkins can be installed properly."),(0,i.kt)("p",null,"In this step we will deploy Jenkins on our EC2 instance by completing the following tasks:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#connecting-to-our-linux-instance"},"Connecting to Our Linux Instance")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#downloading-and-installing-jenkins"},"Downloading and Installing Jenkins")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#configuring-jenkins"},"Configuring Jenkins"))),(0,i.kt)("h3",{id:"connecting-to-our-linux-instance"},"Connecting to Our Linux Instance"),(0,i.kt)("p",null,"After we launch our instance, we can connect to it and use it the same way as our local machine."),(0,i.kt)("p",null,"Before we connect to our instance, get the public DNS name of the instance using the Amazon EC2 console."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Error loading ec2-public-dns.png",src:n(9981).Z,width:"1862",height:"671"})),(0,i.kt)("p",null,"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"ssh")," command to connect to the instance. We will specify the private key (.pem) file and\n",(0,i.kt)("inlineCode",{parentName:"p"},"ec2-user@public_dns_name"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'ssh -i "/path/my-key-pair.pem" ubuntu@ec2-198-51-100-1.compute-1.amazonaws.com\n')),(0,i.kt)("p",null,"We will receive a response like the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"The authenticity of host 'ec2-198-51-100-1.compute1.amazonaws.com (10.254.142.33)' cant be\nestablished.\n\nRSA key fingerprint is 1f:51:ae:28:bf:89:e9:d8:1f:25:5d:37:2d:7d:b8:ca:9f:f5:f1:6f.\n\nAre you sure you want to continue connecting\n(yes/no)?\n")),(0,i.kt)("p",null,'Enter "yes". We will receive a response like the following:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Warning: Permanently added 'ec2-198-51-100-1.compute1.amazonaws.com' (RSA) to the list of known hosts.\n")),(0,i.kt)("h3",{id:"downloading-and-installing-jenkins"},"Downloading and Installing Jenkins"),(0,i.kt)("h4",{id:"installing-java"},"Installing Java"),(0,i.kt)("p",null,"Jenkins requires Java in order to run, yet certain distributions don't include this by default and some Java versions\nare incompatible with Jenkins, because ",(0,i.kt)("strong",{parentName:"p"},"Jenkins requires Java 11 or 17 since Jenkins 2.357 and LTS 2.361.1"),"."),(0,i.kt)("p",null,"There are multiple Java implementations which we can use. ",(0,i.kt)("a",{parentName:"p",href:"https://openjdk.java.net/"},"OpenJDK")," is the most popular one\nat the moment, we will use it in this guide."),(0,i.kt)("p",null,"Update the Debian apt repositories, install OpenJDK 11, and check the installation with the commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ sudo apt update\n$ sudo apt install openjdk-11-jre\n$ java -version\nopenjdk version "11.0.12" 2021-07-20\nOpenJDK Runtime Environment (build 11.0.12+7-post-Debian-2)\nOpenJDK 64-Bit Server VM (build 11.0.12+7-post-Debian-2, mixed mode, sharing)\n')),(0,i.kt)("h4",{id:"installing-jenkins"},"Installing Jenkins"),(0,i.kt)("p",null,"On Debian and Debian-based distributions like Ubuntu, i.e. our EC2 base image, we can install Jenkins through ",(0,i.kt)("inlineCode",{parentName:"p"},"apt"),"."),(0,i.kt)("h5",{id:"long-term-support-release"},"Long Term Support Release"),(0,i.kt)("p",null,"A Jenkins ",(0,i.kt)("a",{parentName:"p",href:"https://www.jenkins.io/download/lts/"},"LTS (Long-Term Support) release")," is chosen every 12 weeks from the\nstream of regular releases as the stable release for that time period. It can be installed from the\n",(0,i.kt)("a",{parentName:"p",href:"https://pkg.jenkins.io/debian-stable/"},"debian-stable apt repository"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo tee \\\n/usr/share/keyrings/jenkins-keyring.asc > /dev/null\n\necho deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] \\\nhttps://pkg.jenkins.io/debian-stable binary/ | sudo tee \\\n/etc/apt/sources.list.d/jenkins.list > /dev/null\n\nsudo apt-get update\nsudo apt-get install jenkins\n")),(0,i.kt)("p",null,"Beginning with Jenkins 2.335 and Jenkins 2.332.1, the package is configured with ",(0,i.kt)("strong",{parentName:"p"},"systemd")," rather than the older\nSystem V init, so we would use systemd extensively to configure Jenkins next."),(0,i.kt)("p",null,"The package installation will:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Setup Jenkins as a daemon launched on start. Run ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"systemctl cat jenkins"))," for more details.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'Create a "',(0,i.kt)("strong",{parentName:"p"},"jenkins"),'" user to run this service. This username is very important because it would be used latter\nduring ',(0,i.kt)("a",{parentName:"p",href:"#enable-ssl-on-jenkins-server-ubuntu"},"HTTPS/SSL configuration")),(0,i.kt)("admonition",{parentName:"li",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},'To verify user "jenkins" has been created, run ',(0,i.kt)("inlineCode",{parentName:"p"},"cat /etc/passwd"),'. Every user on a Linux system, whether created as an\naccount for a real human being or associated with a particular service or system function, is stored in a file called\n"',(0,i.kt)("strong",{parentName:"p"},"/etc/passwd"),'", which contains information about the users on the system. Each line describes a distinct user.'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Direct console log output to ",(0,i.kt)("inlineCode",{parentName:"p"},"systemd-journald"),". Run ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"journalctl -u jenkins.service -r"))," if we are troubleshooting\nJenkins.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Populate ",(0,i.kt)("inlineCode",{parentName:"p"},"/lib/systemd/system/jenkins.service")," with configuration parameters for the launch, e.g ",(0,i.kt)("inlineCode",{parentName:"p"},"JENKINS_HOME"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Set Jenkins to listen on port 8080. Access this port with our browser to start configuration. Note that this is not\na secure port because it is a HTTP port. We would change this port in a moment for better security."))),(0,i.kt)("h5",{id:"weekly-release"},"Weekly Release"),(0,i.kt)("p",null,"Alternatively, a new release is produced weekly to deliver bug fixes and features to users and plugin developers. It can\nbe installed from the ",(0,i.kt)("a",{parentName:"p",href:"https://pkg.jenkins.io/debian/"},"debian apt repository"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl -fsSL https://pkg.jenkins.io/debian/jenkins.io.key | sudo tee \\\n  /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n\necho deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] \\\n  https://pkg.jenkins.io/debian binary/ | sudo tee \\\n  /etc/apt/sources.list.d/jenkins.list > /dev/null\n\nsudo apt-get update\nsudo apt-get install jenkins\n")),(0,i.kt)("h2",{id:"enable-ssl-on-jenkins-server-ubuntu"},"Enable SSL on Jenkins Server (Ubuntu)"),(0,i.kt)("p",null,"It is very important to secure Jenkins by enabling SSL which runs in a project environment. This section is designed to\nintroduce the Secure Sockets Layer (SSL) application-level protocol, and particularly the OpenSSL implementation of\nSSL, in the context of using in Jenkins. After a brief description of exactly what OpenSSL is, and what it is useful\nfor, the section will further illustrate the practical usage of OpenSSL in Jenkins service for the purpose of serving\nsecured Jenkins resources from our EC2 instance."),(0,i.kt)("p",null,"While previous familiarity with Server Sockets Layer (SSL), or the OpenSSL implementation in particular, is not required\nfor this section, if desired, the reader is advised to pursue further learning from the ",(0,i.kt)("a",{parentName:"p",href:"#resources"},"resources")," listed\nbelow in order to broaden his/her understanding of this powerful security layer."),(0,i.kt)("h3",{id:"resources"},"Resources"),(0,i.kt)("h4",{id:"local-system-resources"},"Local System Resources"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"command"),(0,i.kt)("th",{parentName:"tr",align:null},"description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"man config"))),(0,i.kt)("td",{parentName:"tr",align:null},"System manual page for the OpenSSL library configuration files")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"man gendsa"))),(0,i.kt)("td",{parentName:"tr",align:null},"System manual page for the gendsa DSA private key generator")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"man genrsa"))),(0,i.kt)("td",{parentName:"tr",align:null},"System manual page for the genrsa RSA private key generator")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"man openssl"))),(0,i.kt)("td",{parentName:"tr",align:null},"System manual page for the openssl command-line tool")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"man rand"))),(0,i.kt)("td",{parentName:"tr",align:null},"System manual page for the rand pseudo-random byte generator utility")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},(0,i.kt)("inlineCode",{parentName:"strong"},"man x509"))),(0,i.kt)("td",{parentName:"tr",align:null},"System manual page for the x509 certificate display and signing utility")))),(0,i.kt)("h4",{id:"www-resources"},"WWW Resources"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"http://www.openssl.org/"},"OpenSSL Website")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"http://www.ietf.org/html.charters/pkix-charter.html"},"Public Key Infrastructure (X.509) (pkix)"))),(0,i.kt)("h3",{id:"about-openssl"},"About OpenSSL"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Secure Sockets Layer"),' is an application-level protocol which was developed by the Netscape Corporation for the\npurpose of transmitting sensitive information, such as Credit Card details, via the Internet. SSL works by using a\nprivate key to encrypt data transferred over the SSL-enabled connection, thus thwarting eavesdropping of the\ninformation. The most popular use of SSL is in conjunction with web browsing (using the HTTP protocol), but many network\napplications can benefit from using SSL. By convention, URLs that require an SSL connection start with "https:" instead\nof "http:"'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"OpenSSL")," is a robust, commercial-grade implementation of SSL tools, and related general purpose library based upon\nSSLeay, developed by Eric A. Young and Tim J. Hudson. OpenSSL is available as an Open Source equivalent to commercial\nimplementations of SSL via an ",(0,i.kt)("a",{parentName:"p",href:"http://www.openssl.org/source/license.html"},"Apache-style license"),"."),(0,i.kt)("h4",{id:"about-x509"},"About X.509"),(0,i.kt)("p",null,"X.509 is a specification for digital certificates published by the International Telecommunications Union -\nTelecommunication (ITU-T). It specifies information and attributes required for the identification of a person or a\ncomputer system, and is used for secure management and distribution of digitally signed certificates across secure\nInternet networks. OpenSSL most commonly uses X.509 certificates."),(0,i.kt)("h3",{id:"installing-openssl-toolkit"},"Installing OpenSSL Toolkit"),(0,i.kt)("p",null,"AWS EC2 instance usually have OpenSSL installed and configured properly."),(0,i.kt)("h3",{id:"generating-ssl-certificates"},"Generating SSL Certificates"),(0,i.kt)("p",null,"Once we have properly generated an X.509-compliant SSL certificate, we may either elect to"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"sign the certificate by ourselves by ",(0,i.kt)("a",{parentName:"li",href:"#self-signing-a-certificate"},"generating a Certificate Authority (CA)"),", or"),(0,i.kt)("li",{parentName:"ul"},"have a globally recognized Certificate Authority ",(0,i.kt)("a",{parentName:"li",href:"#applying-for-a-certificate-using-certbot"},"sign the certificate"),". We\ncan use services such as ",(0,i.kt)("a",{parentName:"li",href:"https://letsencrypt.org/"},"Letsencrypt")," for valid SSL certificates. But these certificates\nhave to be renewed every three months.")),(0,i.kt)("p",null,"When the certificate is signed, it is then ready to be used with the OpenSSL toolkit, or the library to enable encrypted\nSSL connections to a Lightweight Directory Access Protocol, (LDAP) or Hyper Text Transport Protocol (HTTP) server, for\nexample. The following sections describe the certificate generation, and signing process for both self-signed, and\nrecognized CA-signed certificates."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Note that this section has no Jenkins involved and sets up SSL in a more general context")),(0,i.kt)("h4",{id:"self-signing-a-certificate"},"Self-signing a Certificate"),(0,i.kt)("h5",{id:"establishing-a-certificate-authority"},"Establishing a Certificate Authority"),(0,i.kt)("admonition",{title:"What is a Self-Signed Certificate?",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"A ",(0,i.kt)("strong",{parentName:"p"},"self-signed certificate")," is an SSL/TSL certificate not signed by a public or private certificate authority.\nInstead, it is signed by the creator\u2019s own personal or root CA certificate."),(0,i.kt)("p",{parentName:"admonition"},"Here is what we do to request paid SSL/TLS certificate from a ",(0,i.kt)("strong",{parentName:"p"},"well-known Certificate Authority")," like Verisign or\ncomodo."),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("img",{alt:"Error loading well-known-certificate-authority.png",src:n(1495).Z,width:"869",height:"816"})),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},"Create a ",(0,i.kt)("strong",{parentName:"li"},"certificate signing request (CSR)")," with a private key. A CSR contains details about location,\norganization, and FQDN (Fully Qualified Domain Name)."),(0,i.kt)("li",{parentName:"ol"},"Send the CSR to the trusted CA authority."),(0,i.kt)("li",{parentName:"ol"},"The CA authority will send us the SSL certificate signed by their root certificate authority and private key."),(0,i.kt)("li",{parentName:"ol"},"We can then validate and use the SSL certificate with our applications.")),(0,i.kt)("p",{parentName:"admonition"},"But for a ",(0,i.kt)("strong",{parentName:"p"},"self-signed certificate"),", here is what we do."),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("img",{alt:"Error loading self-signed-cert.png",src:n(7911).Z,width:"872",height:"1044"})),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},"Create our own root CA certificate & CA private key (We act as a CA on our own)"),(0,i.kt)("li",{parentName:"ol"},"Create a server private key to generate CSR"),(0,i.kt)("li",{parentName:"ol"},"Create an SSL certificate with CSR using our root CA and CA private key."),(0,i.kt)("li",{parentName:"ol"},"Install the CA certificate in the browser or Operating system to avoid security warnings.")),(0,i.kt)("p",{parentName:"admonition"},"Most browsers & operating systems hold a copy of root CA certificates of all the trusted certified Certificated\nAuthorities. That's the reason the browsers won't show any security messages when we visit standard websites that use\nSSL from a trusted and well-known commercial Certificate authority. For example, the following image shows the root CA\npresent in the Firefox browser by default."),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("img",{alt:"Error loading trusted-ca.png",src:n(9866).Z,width:"669",height:"652"})),(0,i.kt)("p",{parentName:"admonition"},"At the same time, if we use a self-signed certificate, our browser will throw a security warning. The reason is browsers\nonly trust SSL from a trusted Certificate authority. For example,"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Your connection is not private\nAttackers might be trying to steal your information from demo.apps.mlopshub.com (for example, passwords, messages or\ncredit cards)\n")),(0,i.kt)("p",{parentName:"admonition"},"But we can force browsers & operating systems to accept our own certificate authority. So we won't see the security\nwarning once we install the CA certificate and add it to the trusted list. We can also share the CA certificate with our\ndevelopment team to install in their browsers as well."),(0,i.kt)("p",{parentName:"admonition"},"Also, we can use this CA to create ",(0,i.kt)("strong",{parentName:"p"},"more than one SSL certificate"),".")),(0,i.kt)("p",null,"Self-signed certificates have a major advantage in that they are completely free to use, and they may be generated,\nsigned, and used on an as-needed basis. Self-signed certificates are great for use in closed-lab environments or for\ntesting purposes. One of the drawbacks of using self-signed certificates, however, is that warnings will typically be\nissued by a user's Web browser, and other applications, upon accessing an SSL-secured server that uses a self-signed\ncertificate. By default, client applications (e.g., Firefox) will suppress such warnings for certificates that are\nsigned using only a globally-recognized and trusted Certificate Authority, but warnings may also be squelched by\nimporting a server's root certificate into client applications; a relevant demonstration is shown later in this guide.\nUsing self-signed certificates in a publicly-accessible, production environment is not recommended due to the implicit\ntrust issues arising from these warnings, in addition to the potential confusion caused to users."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},'We must obtain a certificate signed by a recognized Certificate Authority in order to establish a commercial site, e.g.,\nfor conducting "e-commerce", which is however not the case in the context of Jenkins we deiscuss here')),(0,i.kt)("p",null,"Provided we've have the OpenSSL toolkit properly installed on our EC2 instance, the generation of X.509 SSL certificates\nis quite simple. For self-signed certificates, we must ",(0,i.kt)("strong",{parentName:"p"},"first establish a Certificate Authority (CA)")," by following the\nsteps below:"),(0,i.kt)("p",null,"First, create an initial working environment, for example within our home directory by issuing the following command\nfrom a terminal prompt:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cd && mkdir -p myCA/signedcerts && mkdir myCA/private && cd myCA\n")),(0,i.kt)("p",null,'The above command will place us in a newly-created subdirectory of our home directory named "myCA", and within this\nsubdirectory, we should have two additional subdirectories named "signedcerts" and "private".'),(0,i.kt)("p",null,"Within this initial working environment, the significance of the subdirectories, and their contents is as follows:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"~/myCA"),": contains CA certificate, certificates database, generated certificates, keys, and requests"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"~/myCA/signedcerts"),": contains copies of each signed certificate"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"~/myCA/private"),": contains the private key")),(0,i.kt)("p",null,"Next, create an initial certificate database in the ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA")," subdirectory with the following command at a terminal\nprompt:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"echo '01' > serial  && touch index.txt\n")),(0,i.kt)("p",null,"Now create an initial ",(0,i.kt)("strong",{parentName:"p"},"caconfig.cnf")," file suitable for the creation of CA certificates. Using our favorite editor,\nedit the file ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA/caconfig.cnf"),", and insert the following content into the file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano ~/myCA/caconfig.cnf\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"# My sample caconfig.cnf file.\n#\n# Default configuration to use when one is not provided on the command line.\n#\n[ ca ]\ndefault_ca      = local_ca\n#\n#\n# Default location of directories and files needed to generate certificates.\n#\n[ local_ca ]\ndir             = /home/<username>/myCA\ncertificate     = $dir/cacert.pem\ndatabase        = $dir/index.txt\nnew_certs_dir   = $dir/signedcerts\nprivate_key     = $dir/private/cakey.pem\nserial          = $dir/serial\n#\n#\n# Default expiration and encryption policies for certificates.\n#\ndefault_crl_days        = 365\ndefault_days            = 1825\ndefault_md              = sha1\n#\npolicy          = local_ca_policy\nx509_extensions = local_ca_extensions\n#\n#\n# Copy extensions specified in the certificate request\n#\ncopy_extensions = copy\n#\n#\n# Default policy to use when generating server certificates.  The following\n# fields must be defined in the server certificate.\n#\n[ local_ca_policy ]\ncommonName              = supplied\nstateOrProvinceName     = supplied\ncountryName             = supplied\nemailAddress            = supplied\norganizationName        = supplied\norganizationalUnitName  = supplied\n#\n#\n# x509 extensions to use when generating server certificates.\n#\n[ local_ca_extensions ]\nbasicConstraints        = CA:false\n#\n#\n# The default root certificate generation policy.\n#\n[ req ]\ndefault_bits    = 2048\ndefault_keyfile = /home/<username>/myCA/private/cakey.pem\ndefault_md      = sha1\n#\nprompt                  = no\ndistinguished_name      = root_ca_distinguished_name\nx509_extensions         = root_ca_extensions\n#\n#\n# Root Certificate Authority distinguished name.  Change these fields to match\n# your local environment!\n#\n[ root_ca_distinguished_name ]\ncommonName              = MyOwn Root Certificate Authority\nstateOrProvinceName     = NC\ncountryName             = US\nemailAddress            = root@tradeshowhell.com\norganizationName        = Trade Show Hell\norganizationalUnitName  = IT Department\n#\n[ root_ca_extensions ]\nbasicConstraints        = CA:true\n")),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Make sure to adjust the site-specific details in the file, such as the two instances of ",(0,i.kt)("inlineCode",{parentName:"p"},"/home/<username>/")," under\n",(0,i.kt)("inlineCode",{parentName:"p"},"[ local_ca ]")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"[ req ]"),". Also change ",(0,i.kt)("inlineCode",{parentName:"p"},"commonName"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"stateOrProvinceName")," ",(0,i.kt)("inlineCode",{parentName:"p"},"countryName")," etc under\n",(0,i.kt)("inlineCode",{parentName:"p"},"[ root_ca_distinguished_name ]")," accordingly. For more information on the directives contained within this configuration\nfile, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"man config")," command.")),(0,i.kt)("p",null,"When we've edited the file to match our environment, save the file as ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA/caconfig.cnf"),"."),(0,i.kt)("p",null,"Next, we need to generate the ",(0,i.kt)("strong",{parentName:"p"},"Certificate Authority Root Certificate")," and ",(0,i.kt)("strong",{parentName:"p"},"Key"),", by issuing a few commands. First,\ndo this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"export OPENSSL_CONF=~/myCA/caconfig.cnf\n")),(0,i.kt)("p",null,"The previous command sets an environment variable, ",(0,i.kt)("inlineCode",{parentName:"p"},"OPENSSL_CONF"),", which forces the openssl tool to look for a\nconfiguration file in an alternative location (in this case, ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA/caconfig.cnf"),")."),(0,i.kt)("p",null,"Now, generate the CA certificate and key with the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"openssl req -x509 -newkey rsa:2048 -out cacert.pem -outform PEM -days 1825\n")),(0,i.kt)("p",null,"We should be prompted for a passphrase, and see output similar to this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Generating a 2048 bit RSA private key\n.................................+++\n.................................................................................................+++\nwriting new private key to '/home/bshumate/myCA/private/cakey.pem'\nEnter PEM pass phrase:\nVerifying - Enter PEM pass phrase:\n-----\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Do not forget the passphrase used with the command above!")," We'll need it every time we want to generate and sign a\nnew server or client certificate!"),(0,i.kt)("p",null,"The process above will create a self-signed certificate using PEM format and RSA public/private key encryption. The\ncertificate will be valid for ",(0,i.kt)("em",{parentName:"p"},"1825")," days. The location, and purpose of the resultant files is as follows:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"~/myCA/cacert.pem"),": CA public ",(0,i.kt)("strong",{parentName:"li"},"certificate")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"~/myCA/private/cakey.pem"),": CA private key")),(0,i.kt)("h5",{id:"creating-a-self-signed-server-certificate"},"Creating a Self-Signed Server Certificate"),(0,i.kt)("p",null,"Now that we have a Certificate Authority configured, we may use it to sign self-signed certificates. Prior to beginning\nthe steps below, we may wish to encrypt the certificate's private key with a passphrase. The advantages of encrypting\nthe key with a passphrase include protection of the certificate in the event it is stolen."),(0,i.kt)("p",null,"The certificate cannot be used with SSL-enabled applications without entering the passphrase every time the SSL-enabled\napplication is started. This condition, while being most secure, can present a problem: If the server must be started in\nan unattended manner as in the case of a computer restart, then no one will be available to enter the passphrase, and\nsubsequently the server will not start. One way to eliminate this condition involves a trade-off in security: The key\nmay be decrypted, to remove the passphrase necessity; thus SSL-enabled applications will start automatically, without a\nneed for us to enter a passphrase."),(0,i.kt)("p",null,"To actually generate a self-signed certificate for use with an SSL application, follow this process:"),(0,i.kt)("p",null,"Create the server configuration file, by editing ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA/exampleserver.cnf")," with your favorite text editor. Add this\nexample content:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"#\n# exampleserver.cnf\n#\n\n[ req ]\nprompt                  = no\ndistinguished_name      = server_distinguished_name\nreq_extensions          = v3_req\n\n[ server_distinguished_name ]\ncommonName              = tradeshowhell.com\nstateOrProvinceName     = NC\ncountryName             = US\nemailAddress            = root@tradeshowhell.com\norganizationName        = My Organization Name\norganizationalUnitName  = Subunit of My Large Organization\n\n[ v3_req ]\nbasicConstraints        = CA:FALSE\nkeyUsage                = nonRepudiation, digitalSignature, keyEncipherment\nsubjectAltName          = @alt_names\n\n[ alt_names ]\nDNS.0                   = tradeshowhell.com\nDNS.1                   = alt.tradeshowhell.com\n")),(0,i.kt)("p",null,"Be sure to change the values under ",(0,i.kt)("inlineCode",{parentName:"p"},"server_distinguished_name")," especially the ",(0,i.kt)("strong",{parentName:"p"},"commonName")," value. The commonName value\nmust match the host name (i.e. AWS EC2 ",(0,i.kt)("strong",{parentName:"p"},"Public IPv4 DNS"),"), or CNAME for the host we wish to use the key for. If the\ncommonName does not match the intended hostname, then host/certificate mismatch errors will appear in the client\napplications of clients attempting to access the server."),(0,i.kt)("p",null,"Once we've edited the file appropriately, save it as ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA/exampleserver.cnf"),". Generate the server certificate, and\nkey with the following commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"export OPENSSL_CONF=~/myCA/exampleserver.cnf\n")),(0,i.kt)("p",null,"The previous command sets an environment variable ",(0,i.kt)("inlineCode",{parentName:"p"},"OPENSSL_CONF")," which forces the ",(0,i.kt)("inlineCode",{parentName:"p"},"openssl")," tool to look for a\nconfiguration file in an alternative location (in this case, ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA/exampleserver.cnf"),")."),(0,i.kt)("p",null,"Now generate the certificate, and key:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"openssl req -newkey rsa:1024 -keyout tempkey.pem -keyform PEM -out tempreq.pem -outform PEM\n")),(0,i.kt)("p",null,"We should be prompted for a passphrase, and see output similar to this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Generating a 1024 bit RSA private key\n...++++++\n...............++++++\nwriting new private key to 'tempkey.pem'\nEnter PEM pass phrase:\nVerifying - Enter PEM pass phrase:\n-----\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Don't forget the passphrase!")),(0,i.kt)("p",null,"Next, we may translate the temporary private key into an unencrypted key by using the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"openssl rsa < tempkey.pem > server_key.pem\n")),(0,i.kt)("p",null,"We should be prompted for the passphrase used above, and see the following output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Enter pass phrase:\nwriting RSA key\n")),(0,i.kt)("p",null,"If we wish to leave the key encrypted with a passphrase, we will simply rename the temporary key using the following\ncommand, instead of following the step above:"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"If we use a server key encrypted with a passphrase, the passphrase will have to be entered each time the server\napplication using the encrypted key is started. This means the server application will not start unless someone, or\nsomething enters the key.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"mv tempkey.pem server_key.pem\n")),(0,i.kt)("h5",{id:"signing-the-self-signed-server-certificate"},"Signing the Self-Signed Server Certificate"),(0,i.kt)("p",null,"Now we need to sign the server certificate with the Certificate Authority (CA) key using these commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"export OPENSSL_CONF=~/myCA/caconfig.cnf\n")),(0,i.kt)("p",null,"The previous command modifies the environment variable ",(0,i.kt)("inlineCode",{parentName:"p"},"OPENSSL_CONF")," which forces the ",(0,i.kt)("inlineCode",{parentName:"p"},"openssl")," tool to look for a\nconfiguration file in an alternative location (in this case, ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA/caconfig.cnf")," to switch back to the CA\nconfiguration)."),(0,i.kt)("p",null,"Then sign the certificate as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"openssl ca -in tempreq.pem -out server_crt.pem\n")),(0,i.kt)("p",null,"We will be prompted for the passphrase of the CA key as created in the\n",(0,i.kt)("a",{parentName:"p",href:"#establishing-a-certificate-authority"},"Certificate Authority setup")," section above. Enter this passphrase at the prompt,\nand we will then be prompted to confirm the information in the ",(0,i.kt)("inlineCode",{parentName:"p"},"exampleserver.cnf"),", and finally asked to confirm signing\nthe certificate. Output should be similar to this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Using configuration from /home/bshumate/myCA/caconfig.cnf\nEnter pass phrase for /home/bshumate/myCA/private/cakey.pem:\nCheck that the request matches the signature\nSignature ok\nThe Subject's Distinguished Name is as follows\ncommonName            :PRINTABLE:'tradeshowhell.com'\nstateOrProvinceName   :PRINTABLE:'NC'\ncountryName           :PRINTABLE:'US'\nemailAddress          :IA5STRING:'root@tradeshowhell.com'\norganizationName      :PRINTABLE:'Trade Show Hell'\norganizationalUnitName:PRINTABLE:'Black Ops'\nCertificate is to be certified until Jan  4 21:50:08 2011 GMT (1825 days)\nSign the certificate? [y/n]:y\n\n1 out of 1 certificate requests certified, commit? [y/n]y\nWrite out database with 1 new entries\nData Base Updated\n")),(0,i.kt)("p",null,"Remove the temporary certificate, and key files with the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"rm -f tempkey.pem && rm -f tempreq.pem\n")),(0,i.kt)("p",null,"Hooray! We now have a self-signed server application certificate, and key pair:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"server_crt.pem"),": Server application certificate file"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"server_key.pem"),": Server application key file")),(0,i.kt)("p",null,"Next, we shall use the certificate for our Jenkins instance."),(0,i.kt)("h5",{id:"chrome-bypass-your-connection-is-not-private-message"},'Chrome: Bypass "Your connection is not private" Message'),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Option 1 - ",(0,i.kt)("strong",{parentName:"p"},"Simply Proceed"),': If Chrome says the security certificate is from the same domain we are attempting to\nlogin to, it is likely there is nothing to worry about when this warning appears. To proceed, simply choose the\n"',(0,i.kt)("strong",{parentName:"p"},"Advanced"),'" link, then choose "',(0,i.kt)("inlineCode",{parentName:"p"},"Proceed to <link> (unsafe)"),'".'),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"Error loading Chrome-Advanced.png",src:n(3442).Z,width:"500",height:"419"}),"\n",(0,i.kt)("img",{alt:"Error loading Chrome-proceed-unsafe.png",src:n(6337).Z,width:"578",height:"195"}))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Option 2 - ",(0,i.kt)("strong",{parentName:"p"},"Prevent Warning"),": Click a blank section of the denial page and use our keyboard, type ",(0,i.kt)("inlineCode",{parentName:"p"},"thisisunsafe"),".\nThis will add the website to a safe list, where we should not be prompted again. ",(0,i.kt)("em",{parentName:"p"},"Strange steps, but it surely\nworks!")))),(0,i.kt)("h4",{id:"applying-for-a-certificate-using-certbot"},"Applying for a Certificate using Certbot"),(0,i.kt)("admonition",{title:"Requirements",type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("img",{alt:"Error loading certbot-requirements.png",src:n(2321).Z,width:"2100",height:"558"}))),(0,i.kt)("h5",{id:"install-and-setup-certbot"},"Install and Setup Certbot"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"SSH into the server")," SSH into the server (i.e. EC2 instance) running our Jenkins instance as a user with sudo\nprivileges.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Install snapd")," from command line"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo apt update\n$ sudo apt install snapd\n")),(0,i.kt)("p",{parentName:"li"},"Either log out and back in again, or restart the EC2 instance, to ensure snap's paths are updated correctly. To test\nour system, install the ",(0,i.kt)("a",{parentName:"p",href:"https://snapcraft.io/hello-world"},"hello-world")," snap and make sure it runs correctly:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo snap install hello-world\nhello-world 6.4 from Canonical\u2713 installed\n$ hello-world\nHello World!\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Ensure that our version of snapd is up to date")," Execute the following instructions on the command line on the\nmachine to ensure that we have the latest version of ",(0,i.kt)("inlineCode",{parentName:"p"},"snapd"),"."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo snap install core; sudo snap refresh core\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Install Certbot")," Run this command on the command line on the machine to install Certbot."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo snap install --classic certbot\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Prepare the Certbot command")," Execute the following instruction on the command line on the machine to ensure that\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"certbot")," command can be run."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo ln -s /snap/bin/certbot /usr/bin/certbot\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Install Nginx")),(0,i.kt)("p",{parentName:"li"}," We would choose Nginx instead of Apache server in this case by installing Nginx using"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo apt install python3-certbot-nginx\n")),(0,i.kt)("p",{parentName:"li"},"Note that Certbot does not install nginx for us automatically and will through us an error, in the next step, of"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"Could not find a usable 'nginx' binary. Ensure nginx exists, the binary is executable, and your PATH is set\ncorrectly\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Get and Install Certificates")," Run this command to get a certificate and have Certbot edit our nginx configuration\nautomatically to serve it, turning on HTTPS access in a single step."),(0,i.kt)("admonition",{parentName:"li",title:"Prerequisite",type:"note"},(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},'A DNS domain record, e.g. "jenkins.my-domain.com", has been setup to use'),(0,i.kt)("li",{parentName:"ol"},"The server running Jenkins can be reached at port 80 publicly"))),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo certbot --nginx\n")),(0,i.kt)("p",{parentName:"li"},"Enter an email address of ours"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo certbot --nginx\nSaving debug log to ...\nEnter email address (used for urgent renewal and security notices)\n (Enter 'c' to cancel):\n")),(0,i.kt)("p",{parentName:"li"},"Next give content to the Terms of Service and decide whether or not to receive promotion emails from Let's Encrypt\nand Certbot"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nPlease read the Terms of Service at\nhttps://letsencrypt.org/documents/LE-SA-v1.3-September-21-2022.pdf. You must\nagree in order to register with the ACME server. Do you agree?\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n(Y)es/(N)o: Y\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nWould you be willing, once your first certificate is successfully issued, to\nshare your email address with the Electronic Frontier Foundation, a founding\npartner of the Let's Encrypt project and the non-profit organization that\ndevelops Certbot? We'd like to send you email about our work encrypting the web,\nEFF news, campaigns, and ways to support digital freedom.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n(Y)es/(N)o: Y\n")),(0,i.kt)("p",{parentName:"li"},'As the last step, provide the domain name sitting in front of our Jenkins instance. Let\'s give it as\n"jenkins.my-domain.com"'),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Account registered.\nPlease enter the domain name(s) you would like on your certificate (comma and/or\nspace separated) (Enter 'c' to cancel): jenkins.my-domain.com\nRequesting a certificate for jenkins.my-domain.com\n")),(0,i.kt)("p",{parentName:"li"},"If everything works successfully, we shall see the output similar to the one below"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Successfully received certificate.\nCertificate is saved at: /path/to/server_crt.pem\nKey is saved at:         /path/to/server_key.pem\nThis certificate expires on ****-**-**.\nThese files will be updated when the certificate renews.\nCertbot has set up a scheduled task to automatically renew this certificate in the background.\n\nDeploying certificate\nSuccessfully deployed certificate for jenkins.my-domain.com to /some/path/...\nCongratulations! You have successfully enabled HTTPS on <https://jenkins.my-domain.com>\n\n...\n")),(0,i.kt)("admonition",{parentName:"li",title:"Troubleshooting",type:"tip"},(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Please enter the domain name(s) you would like on your certificate (comma and/or\nspace separated) (Enter 'c' to cancel): jenkins.my-domain.com\nRequesting a certificate for jenkins.my-domain.com\n\nCertbot failed to authenticate some domains (authenticator: nginx). The Certificate Authority reported these\nproblems:\nDomain: jenkins.my-domain.com\nType:   connection\nDetail: ...: Timeout during connect (likely firewall problem)\n\nHint: The Certificate Authority failed to verify the temporary nginx configuration changes made by Certbot. Ensure\nthe listed domains point to this nginx server and that it is accessible from the internet.\n\nSome challenges have failed.\nAsk for help or search for solutions at https://community.letsencrypt.org. See the logfile\n/var/log/letsencrypt/letsencrypt.log or re-run Certbot with -v for more details.\n")),(0,i.kt)("p",{parentName:"admonition"},"This problem usually happens when we are re-deploying certificate. There are cases when we would like to deploy\nJenkins to a new server or VM and we are setting everything up anew. We then would want to request the same\ncertificate. ",(0,i.kt)("em",{parentName:"p"},'But before we do this our DNS record (i.e. "jenkins.my-domain.com") is still pointing to the old\nJenkins instance which in most cases has already been unreachable'),". The solution then is to delete that DNS record\nfrom our domain config"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Please enter the domain name(s) you would like on your certificate (comma and/or\nspace separated) (Enter 'c' to cancel): jenkins.my-domain.com\nRequesting a certificate for jenkins.my-domain.com\n\nCertbot failed to authenticate some domains (authenticator: nginx). The Certificate Authority reported these\nproblems:\nDomain: jenkins.my-domain.com\nType:   dns\nDetail: DNS problem: NXDOMAIN looking up A for jenkins.my-domain.com - check that a DNS record exists for this\ndomain; DNS problem: NXDOMAIN looking up AAAA for jenkins.my-domain.com - check that a DNS record exists for this\ndomain\n\nHint: The Certificate Authority failed to verify the temporary nginx configuration changes made by Certbot. Ensure\nthe listed domains point to this nginx server and that it is accessible from the internet.\n\nSome challenges have failed.\nAsk for help or search for solutions at https://community.letsencrypt.org. See the logfile\n/var/log/letsencrypt/letsencrypt.log or re-run Certbot with -v for more details.\n")),(0,i.kt)("p",{parentName:"admonition"},"This error is rather straightforward. After we delete the DNS record, we simply forgot to link the DNS record to\na new server/VM IP")),(0,i.kt)("p",{parentName:"li"},'Remember the two paths from the command above: "',(0,i.kt)("strong",{parentName:"p"},"/path/to/server_crt.pem"),'" and "',(0,i.kt)("strong",{parentName:"p"},"/path/to/server_key.pem"),'". We\nwill need them in order to ',(0,i.kt)("a",{parentName:"p",href:"#convert-ssl-keys-to-pkcs12-format"},"load certificate onto Jenkins instance"),' later. In\naddition, under "/path/to/" there is also the CA certificate "',(0,i.kt)("strong",{parentName:"p"},"/path/to/cert.pem"),'", which we will be using'),(0,i.kt)("admonition",{parentName:"li",type:"tip"},(0,i.kt)("mdxAdmonitionTitle",{parentName:"admonition"},(0,i.kt)("strong",{parentName:"mdxAdmonitionTitle"},"Or"),", just get a certificate"),(0,i.kt)("p",{parentName:"admonition"},"If you're feeling more conservative and would like to make the changes to the nginx configuration by hand, run this\ncommand instead of the one above:"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo certbot certonly --nginx\n")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Test automatic renewal")," The Certbot packages on our system come with a cron job or systemd timer that will renew\nour certificates automatically before they expire. We will not need to run Certbot again, unless we change our\nconfiguration. We can test automatic renewal for our certificates by running this command:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo certbot renew --dry-run\n")),(0,i.kt)("admonition",{parentName:"li",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"The command to renew certbot is installed in one of the following locations:"),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/etc/crontab/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/etc/cron.*/*")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"systemctl list-timers")))))),(0,i.kt)("h4",{id:"convert-ssl-keys-to-pkcs12-format"},"Convert SSL keys to PKCS12 format"),(0,i.kt)("p",null,"When ",(0,i.kt)("a",{parentName:"p",href:"#generating-ssl-certificates"},"SSL is ready"),", let's enable secure connection to our Jenkins instance. We would need\nthe following files:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"server_crt.pem")," - The signed certificate"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"server_key.pem")," - The certificate key"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"cacert.pem")," - The CA certificate")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"In the case of ",(0,i.kt)("a",{parentName:"em",href:"#self-signing-a-certificate"},"self-signed certificate"))),", under ",(0,i.kt)("inlineCode",{parentName:"p"},"~/myCA")," directory, execute"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"openssl pkcs12 -export -out jenkins.p12 \\\n-passout 'pass:your-strong-password' -inkey server_key.pem \\\n-in server_crt.pem -certfile cacert.pem -name jenkins.some-domain.com\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"In the case of ",(0,i.kt)("a",{parentName:"strong",href:"#applying-for-a-certificate-using-certbot"},"publicly authorized certificate"))),", run"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo openssl pkcs12 -export \\\n    -out jenkins.p12 \\\n    -passout 'pass:your-strong-password' \\\n    -inkey /path/to/server_key.pem \\\n    -in /path/to/server_crt.pem \\\n    -certfile /path/to/cert.pem \\\n    -name jenkins.some-domain.com\n")),(0,i.kt)("p",null,"where ",(0,i.kt)("inlineCode",{parentName:"p"},"your-strong-password"),' would be a password of our choice; for example, if you choose "sdfef3qxA" as the password,\nput ',(0,i.kt)("inlineCode",{parentName:"p"},"-passout 'pass:sdfef3qxA'"),' there. Replace all the occurrences of "your-secrete-password" seen below with\n"sdfef3qxA". In adiition, ',(0,i.kt)("em",{parentName:"p"},'Replace "jenkins.some-domain.com" with our own CNAME')),(0,i.kt)("p",null,"The command given above converts SSL certs to intermediate PKCS12 format named ",(0,i.kt)("strong",{parentName:"p"},"jenkins.p12"),"."),(0,i.kt)("h4",{id:"convert-pkcs12-to-jks-format"},"Convert PKCS12 to JKS format"),(0,i.kt)("p",null,"Use the following keytool command to convert the ",(0,i.kt)("inlineCode",{parentName:"p"},"jenkins.p12")," file to JKS format."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"keytool -importkeystore -srckeystore jenkins.p12 \\\n-srcstorepass 'your-secret-password' -srcstoretype PKCS12 \\\n-srcalias jenkins.some-domain.com -deststoretype JKS \\\n-destkeystore jenkins.jks -deststorepass 'your-secret-password' \\\n-destalias jenkins.some-domain.com\n")),(0,i.kt)("p",null,"Replace the following with our own values:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-srcstorepass")," - ",(0,i.kt)("a",{parentName:"li",href:"#convert-ssl-keys-to-pkcs12-format"},"The password we created above")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-deststorepass")," - A new password we created in this step"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-srcalias"),' - The "jenkins.some-domain.com" or our own CNAME we used\n',(0,i.kt)("a",{parentName:"li",href:"#convert-ssl-keys-to-pkcs12-format"},"from the previous step")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"-destalias")," - A destination CNAME, usually the same as ",(0,i.kt)("inlineCode",{parentName:"li"},"srcalias"))),(0,i.kt)("p",null,"We should, after the command is executed, see a file named ",(0,i.kt)("strong",{parentName:"p"},"jenkins.jks")," in the current location."),(0,i.kt)("h4",{id:"add-jks-to-jenkins-path"},"Add JKS to Jenkins Path"),(0,i.kt)("p",null,"The jenkins.jks file should be saved in a specific location where Jenkins can access it. Let's create a folder for it\nand move the jenkins.jks key to that location."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo mkdir -p /etc/jenkins\nsudo cp jenkins.jks /etc/jenkins/\n")),(0,i.kt)("p",null,"Change the permissions of the keys and folder."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo chown -R jenkins: /etc/jenkins\nsudo chmod 700 /etc/jenkins\nsudo chmod 600 /etc/jenkins/jenkins.jks\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"jenkins:")," used in the first command is a standard Jenkins user that get's created when we install\n",(0,i.kt)("a",{parentName:"p",href:"#long-term-support-release"},"Jenkins package"),'. We are essentially granting permission for that user here so do not\nthrow some other "smart" names there or change, please.')),(0,i.kt)("h4",{id:"modify-jenkins-configuration-for-ssl"},"Modify Jenkins Configuration for SSL"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl edit jenkins\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},'### Anything between here and the comment below will become the new contents of the file\n\n[Service]\nEnvironment="JENKINS_PORT=-1"\nEnvironment="JENKINS_HTTPS_PORT=443"\nEnvironment="JENKINS_HTTPS_KEYSTORE=/etc/jenkins/jenkins.jks"\nEnvironment="JENKINS_HTTPS_KEYSTORE_PASSWORD=<some strong password>"\nEnvironment="JENKINS_HTTPS_LISTEN_ADDRESS=0.0.0.0"\n\n### Lines below this comment will be discarded\n')),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"The config content above actually gets appended to the end of ",(0,i.kt)("inlineCode",{parentName:"p"},"systemctl cat jenkins")," output, which we can verify to\nmake sure that the changes here actually propagates to Jenkins runtime."),(0,i.kt)("p",{parentName:"admonition"},"Ignore the comments lines which starts with ",(0,i.kt)("inlineCode",{parentName:"p"},"### ..."))),(0,i.kt)("h4",{id:"restart-jenkins"},"Restart Jenkins"),(0,i.kt)("p",null,"The restart command on Ubuntu C2 instance is"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl restart jenkins.service\n")),(0,i.kt)("p",null,"which would probably fail, however, with the error"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ sudo systemctl restart jenkins.service\nJob for jenkins.service failed because the control process exited with error code.\nSee "systemctl status jenkins.service" and "journalctl -xeu jenkins.service" for details.\n')),(0,i.kt)("p",null,"Whenever Jenkins control failes with ",(0,i.kt)("inlineCode",{parentName:"p"},"systemctl"),", we can use its diagnosing command ",(0,i.kt)("inlineCode",{parentName:"p"},"journalctl")," to further investigate:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"journalctl -u jenkins.service -r\n")),(0,i.kt)("p",null,"which probably would show us the follwoing error"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"Caused: java.io.IOException: Failed to bind to /0.0.0.0:443\n        at org.eclipse.jetty.server.ServerConnector.openAcceptChannel(ServerConnector.java:339)\n        at java.base/sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:227)\n        at java.base/sun.nio.ch.Net.bind(Net.java:448)\n        at java.base/sun.nio.ch.Net.bind(Net.java:459)\n        at java.base/sun.nio.ch.Net.bind0(Native Method)\njava.net.SocketException: Permission denied\n")),(0,i.kt)("p",null,"This is because Jetty, which is the Jenkins server, does not have sudo permission to listen on SSL port 443 on startup.\nWe could verify this by having Jenkins SSL port listen on a non-sudo port such as 8443. To do so, we will run"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl edit jenkins\n")),(0,i.kt)("p",null,"again and change the line from"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},'Environment="JENKINS_HTTPS_PORT=443"\n')),(0,i.kt)("p",null,"to"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},'Environment="JENKINS_HTTPS_PORT=8443"\n')),(0,i.kt)("p",null,"We will see that Jenkins process started:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ ps -aux | grep jenkins\njenkins    46742 45.1 99.1 3245534 89876543 ?      Ssl  06:12   0:29 /usr/bin/java -Djava.awt.headless=true -jar\n/usr/share/java/jenkins.war --webroot=/var/cache/jenkins/war --httpPort=-1 --httpsPort=8443 --httpsListenAddress=0.0.0.0\n--httpsKeyStore=/etc/jenkins/jenkins.jks --httpsKeyStorePassword=**************\n")),(0,i.kt)("p",null,"We have 2 options."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Instruct ",(0,i.kt)("inlineCode",{parentName:"li"},"sudo systemctl restart jenkins.service")," to execute the command above with ",(0,i.kt)("inlineCode",{parentName:"li"},"sudo")),(0,i.kt)("li",{parentName:"ol"},"Simply add an inbound rule to AWS EC2 security group to have Jenkins HTTPS listen on a port greater than 1024")),(0,i.kt)("p",null,'We would go with the 2nd option in this post. If we want to open the port for HTTPS and it\'s not 443, then in addition\nto adding HTTPS rule, we could also just add a "Custom TCP" rule for the desired port (i.e. 8443) and it will work.'),(0,i.kt)("p",null,"Now we should be able to access Jenkins over HTTPS with port 8443 at ",(0,i.kt)("inlineCode",{parentName:"p"},"https://jenkins.some-domain.com:8443")),(0,i.kt)("h4",{id:"https-via-nginx-reverse-proxy"},"HTTPS via Nginx Reverse Proxy"),(0,i.kt)("p",null,"Proxying is typically used to distribute the load among several servers, seamlessly show content from different\nwebsites, or pass requests for processing to application servers over protocols other than HTTP."),(0,i.kt)("admonition",{title:"What Is a Reverse Proxy Server?",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"A proxy server is a go\u2011between or intermediary server that forwards requests for content from multiple clients to\ndifferent servers across the Internet. A ",(0,i.kt)("strong",{parentName:"p"},"reverse proxy server")," is a type of proxy server that typically sits behind\nthe firewall in a private network and directs client requests to the appropriate backend server. A reverse proxy\nprovides an additional level of abstraction and control to ensure the smooth flow of network traffic between clients and\nservers."),(0,i.kt)("p",{parentName:"admonition"},"Common uses for a reverse proxy server include:"),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Load balancing"),' A reverse proxy server can act as a "traffic cop" sitting in front of backend servers and\ndistributing client requests across a group of servers in a manner that maximizes speed and capacity utilization\nwhile ensuring no one server is overloaded, which can degrade performance. If a server goes down, the load balancer\nredirects traffic to the remaining online servers.'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Web acceleration")," Reverse proxies can compress inbound and outbound data, as well as cache commonly requested\ncontent, both of which speed up the flow of traffic between clients and servers. They can also perform additional\ntasks such as SSL encryption to take load off of your web servers, thereby boosting their performance."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Security & Anonymity")," By intercepting requests headed for your backend servers, a reverse proxy server protects\ntheir identities and acts as an additional defense against security attacks. It also ensures that multiple servers can\nbe accessed from a single record locator or URL regardless of the structure of your local area network."))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Error loading nginx-directives.png",src:n(9994).Z,width:"1023",height:"512"})),(0,i.kt)("h5",{id:"understanding-the-nginx-configuration-file-structure-and-configuration-contexts"},"Understanding the Nginx Configuration File Structure and Configuration Contexts"),(0,i.kt)("p",null,"While we know Certbot utilizes Nginx's capabilities, people are often confused by some of the conventions they find in\nNginx configuration files. In this section, we will focus first on the basic structure of an Nginx configuration file."),(0,i.kt)("p",null,'The main Nginx configuration file is located at "',(0,i.kt)("strong",{parentName:"p"},"/etc/nginx/nginx.conf"),'" in our EC2 Ubuntu instance.'),(0,i.kt)("p",null,"One of the first things that we should notice when looking at the main configuration file is that it appears to be\norganized in a tree-like structure, defined by sets of brackets (that look like ",(0,i.kt)("inlineCode",{parentName:"p"},"{")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"}"),"). In Nginx parlance, the\nareas that these brackets define are called \u201ccontexts\u201d because they contain configuration details that are separated\naccording to their area of concern. Basically, these divisions provide an organizational structure along with some\nconditional logic to decide whether to apply the configurations within."),(0,i.kt)("p",null,"Because contexts can be layered within one another, Nginx provides a level of directive inheritance. As a general rule,\nif a directive is valid in multiple nested scopes, a declaration in a broader context will be passed on to any child\ncontexts as default values. The children contexts can override these values at will. It is worth noting that an override\nto any array-type directives will replace the previous value, not append to it."),(0,i.kt)("p",null,"Directives can only be used in the contexts that they were designed for. Nginx will error out on reading a configuration\nfile with directives that are declared in the wrong context. The\n",(0,i.kt)("a",{parentName:"p",href:"http://nginx.org/en/docs/dirindex.html"},"Nginx documentation")," contains information about which contexts each directive\nis valid in, so it is a great reference if you are unsure."),(0,i.kt)("p",null,"Next, we'll discuss the most common contexts in Nginx."),(0,i.kt)("h6",{id:"the-main-context"},"The Main Context"),(0,i.kt)("p",null,'The most general context is the "main" or "global" context. It is the only context that is not contained within the\ntypical context blocks that look like this:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-config"},"# The main context is here, outside any other contexts\n\n. . .\n\ncontext {\n\n    . . .\n\n}\n")),(0,i.kt)("p",null,'Any directive that exist entirely outside of these blocks is said to inhabit the "main" context. Keep in mind that if\nour Nginx configuration is set up in a modular fashion, some files will contain instructions that appear to exist\noutside of a bracketed context, but which will be included within such a context when the configuration is stitched\ntogether.'),(0,i.kt)("p",null,"The main context represents the broadest environment for Nginx configuration. It is used to configure details that\naffect the entire application on a basic level. While the directives in this section affect the lower contexts, many of\nthese aren't inherited because they cannot be overridden in lower levels."),(0,i.kt)("p",null,'Some common details that are configured in the main context are the user and group to run the worker processes as, the\nnumber of workers, and the file to save the main process\'s PID. We can even define things like worker CPU affinity and\nthe "niceness" of worker processes. The default error file for the entire application can be set at this level (this can\nbe overridden in more specific contexts).'),(0,i.kt)("h6",{id:"the-events-context"},"The Events Context"),(0,i.kt)("p",null,'The "events" context is contained within the "main" context. It is used to set global options that affect how Nginx\n',(0,i.kt)("strong",{parentName:"p"},"handles connections")," at a general level. There can only be a single events context defined within the Nginx\nconfiguration."),(0,i.kt)("p",null,"This context will look like this in the configuration file, outside of any other bracketed contexts:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"# main context\n\nevents {\n\n    # events context\n    . . .\n\n}\n")),(0,i.kt)("p",null,"Nginx uses an event-based connection processing model, so the directives defined within this context determine how\nworker processes should handle connections. Mainly, directives found here are used to either select the connection\nprocessing technique to use, or to modify the way these methods are implemented."),(0,i.kt)("p",null,"Usually, the connection processing method is automatically selected based on the most efficient choice that the platform\nhas available. For Linux systems, the ",(0,i.kt)("em",{parentName:"p"},"epoll")," method is usually the best choice."),(0,i.kt)("p",null,"Other items that can be configured are the number of connections each worker can handle, whether a worker will only take\na single connection at a time or take all pending connections after being notified about a pending connection, and\nwhether workers will take turns responding to events."),(0,i.kt)("h6",{id:"the-http-context"},"The HTTP Context"),(0,i.kt)("p",null,"When configuring Nginx as a web server or ",(0,i.kt)("strong",{parentName:"p"},"reverse proxy"),', the "http" context will hold the majority of the\nconfiguration. This context will contain all of the directives and other contexts necessary to define how the program\nwill handle HTTP or ',(0,i.kt)("strong",{parentName:"p"},"HTTPS")," connections."),(0,i.kt)("p",null,"The http context is a sibling of the events context, so they should be listed side-by-side, rather than nested. They\nboth are children of the main context:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"# main context\n\nevents {\n    # events context\n\n    . . .\n\n}\n\nhttp {\n    # http context\n\n    . . .\n\n}\n")),(0,i.kt)("p",null,"While lower contexts get more specific about how to handle requests, directives at this level control the defaults for\nevery virtual server defined within. A large number of directives are configurable at this context and below, depending\non how we would like the inheritance to function."),(0,i.kt)("p",null,"Some of the directives that we are likely to encounter control the default locations for access and error logs\n(",(0,i.kt)("strong",{parentName:"p"},"access_log")," and ",(0,i.kt)("strong",{parentName:"p"},"error_log"),"), configure asynchronous I/O for file operations (aio, sendfile, and directio), and\nconfigure the server's statuses when errors occur (error_page). Other directives configure compression (gzip and\ngzip_disable), fine-tune the TCP keep alive settings (",(0,i.kt)("strong",{parentName:"p"},"keepalive_disable"),", ",(0,i.kt)("strong",{parentName:"p"},"keepalive_requests"),", and\n",(0,i.kt)("strong",{parentName:"p"},"keepalive_timeout"),"), and the rules that Nginx will follow to try to optimize packets and system calls (sendfile,\ntcp_nodelay, and tcp_nopush). Additional directives configure an application-level document root and index files (root\nand index) and set up the various hash tables that are used to store different types of data (",(0,i.kt)("em",{parentName:"p"},"_hash_bucket_size and\n"),"_hash_max_size for server_names, types, and variables)."),(0,i.kt)("h6",{id:"the-server-context"},"The Server Context"),(0,i.kt)("p",null,'The "server" context is declared within the "http" context. This is our first example of nested, bracketed contexts. It\nis also the first context that allows for multiple declarations.'),(0,i.kt)("p",null,"The general format for server context may look something like this. Remember that these reside within the http context:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"# main context\n\nhttp {\n\n    # http context\n\n    server {\n\n        # first server context\n\n    }\n\n    server {\n\n        # second server context\n\n    }\n\n}\n")),(0,i.kt)("p",null,"The reason for allowing multiple declarations of the server context is that ",(0,i.kt)("strong",{parentName:"p"},"each instance defines a specific virtual\nserver to handle client requests"),". You can have as many server blocks as you need, each of which can handle a specific\nsubset of connections."),(0,i.kt)("p",null,"Due to the possibility and likelihood of multiple server blocks, this context type is also the first that Nginx must use\na selection algorithm to make decisions. Each client request will be handled according to the configuration defined in a\nsingle server context, so Nginx must decide which server context is most appropriate based on details of the request.\nThe directives which decide if a server block will be used to answer a request are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"listen"),": The ",(0,i.kt)("em",{parentName:"li"},"IP:port")," combination that this server block is designed to respond to. If a request is made by a\nclient that matches these values, this block will potentially be selected to handle the connection."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"server_name"),': This directive is the other component used to select a server block for processing. If there are\nmultiple server blocks with listen directives of the same specificity that can handle the request, Nginx will parse\nthe "Host" header of the request and match it against this directive.')),(0,i.kt)("p",null,"The directives in this context can override many of the directives that may be defined in the http context, including\nlogging, the document root, compression, etc. In addition to the directives that are taken from the http context, we\nalso can configure files to try to respond to requests (try_files), issue redirects and rewrites (return and rewrite),\nand set arbitrary variables (set)."),(0,i.kt)("h6",{id:"the-location-context"},"The Location Context"),(0,i.kt)("p",null,"The next context that we will deal with regularly is the location context. Location contexts share many relational\nqualities with server contexts. For example, multiple location contexts can be defined, each location is used to handle\na certain type of client request, and each location is selected by virtue of matching the location definition against\nthe client request through a selection algorithm."),(0,i.kt)("p",null,"While the directives that determine whether to select a server block are defined within the server context, the\ncomponent that decides on a location's ability to handle a request is located in the location definition (the line that\nopens the location block)."),(0,i.kt)("p",null,"The general syntax looks like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-config"},"location match_modifier location_match {\n\n    . . .\n\n}\n")),(0,i.kt)("p",null,"Location blocks live within server contexts and, unlike server blocks, can be nested inside one another. This can be\nuseful for creating a more general location context to catch a certain subset of traffic, and then further processing it\nbased on more specific criteria with additional contexts inside:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"# main context\n\nserver {\n\n    # server context\n\n    location /match/criteria {\n\n        # first location context\n\n    }\n\n    location /other/criteria {\n\n        # second location context\n\n        location nested_match {\n\n            # first nested location\n\n        }\n\n        location other_nested {\n\n            # second nested location\n\n        }\n\n    }\n\n}\n")),(0,i.kt)("p",null,'While server contexts are selected based on the requested IP address/port combination and the host name in the "Host"\nheader, location blocks further divide up the request handling within a server block by looking at the request URI. The\nrequest URI is the portion of the request that comes after the domain name or IP address/port combination.'),(0,i.kt)("p",null,"For example, if a client requests ",(0,i.kt)("inlineCode",{parentName:"p"},"http://www.example.com/blog")," on port 80, the ",(0,i.kt)("inlineCode",{parentName:"p"},"http"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"www.example.com"),', and port 80\nwould all be used to determine which server block to select. After a server is selected, the "/blog" portion (the\nrequest URI), would be evaluated against the defined locations to determine which further context should be used to\nrespond to the request.'),(0,i.kt)("p",null,"Many of the directives you are likely to see in a location context are also available at the parent levels. New\ndirectives at this level allow you to reach locations outside of the document root (alias), mark the location as only\ninternally accessible (internal), and proxy to other servers or locations (using http, fastcgi, scgi, and uwsgi\nproxying)."),(0,i.kt)("h5",{id:"how-certbot--nginx-enable-ssl"},"How Certbot + Nginx Enable SSL"),(0,i.kt)("p",null,"Recall that we have made our Jenkins instance available at ",(0,i.kt)("inlineCode",{parentName:"p"},"https://jenkins.some-domain.com:8443"),' with a port number of\n"8443". If we would like to get rid of it and simply visit Jenkins at ',(0,i.kt)("inlineCode",{parentName:"p"},"https://jenkins.some-domain.com"),", we will add an\nredirect to Certbot-managed Nginx config at ",(0,i.kt)("strong",{parentName:"p"},"/etc/nginx/sites-enabled/default"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-config"},"server {\n\n    location / {\n        proxy_pass https://localhost:8443;\n    }\n\n    listen [::]:443 ssl ipv6only=on;\n    listen 443 ssl;\n    ssl_certificate ...;\n    ssl_certificate_key ...;\n}\n")),(0,i.kt)("p",null,"Note the proxying rule of ",(0,i.kt)("inlineCode",{parentName:"p"},"proxy_pass https://localhost:8443;"),". If, instead, we have some other app that runs on top of\nHTTP only (with port 8080 for example) while our EC2 host has SSL certificate, we would simply have our EC2 instance\ntaking care of all the SSL stuff and proxy all HTTPS request to the HTTP app via ",(0,i.kt)("inlineCode",{parentName:"p"},"proxy_pass http://localhost:8080;")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"We may need to restart EC2 instance for the change above to take effect")),(0,i.kt)("h3",{id:"post-installation-setup-wizard"},"Post-Installation Setup Wizard"),(0,i.kt)("p",null,"After downloading, installing and running Jenkins on SSL, the post-installation setup wizard begins."),(0,i.kt)("p",null,'The setup wizard takes us through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create\nthe first administrator user through which we can continue accessing Jenkins.'),(0,i.kt)("h4",{id:"unlocking-jenkins"},"Unlocking Jenkins"),(0,i.kt)("p",null,"When we first access a new Jenkins instance, we are asked to unlock it using an automatically-generated password. Browse\nto ",(0,i.kt)("inlineCode",{parentName:"p"},"https://jenkins.my-domain.com:8443")," and wait until the Unlock Jenkins page appears."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Error loading unlock-jenkins.png",src:n(6765).Z,width:"1239",height:"783"})),(0,i.kt)("p",null,"As prompted, enter the password found in ",(0,i.kt)("strong",{parentName:"p"},"/var/lib/jenkins/secrets/initialAdminPassword")," on our EC2 instance path. Use\nthe following command to display this password:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"[ec2-user ~]$ sudo cat /var/lib/jenkins/secrets/initialAdminPassword\n")),(0,i.kt)("p",null,"On the Unlock Jenkins page, paste this password into the ",(0,i.kt)("strong",{parentName:"p"},"Administrator password")," field and click ",(0,i.kt)("strong",{parentName:"p"},"Continue"),"."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},'This password also serves as the default administrator account\'s password (with username "admin") if we happen to skip\nthe subsequent user-creation step in the setup wizard (So, DO NOT skip this subsequent step).')),(0,i.kt)("h4",{id:"customizing-jenkins-with-plugins"},"Customizing Jenkins with Plugins"),(0,i.kt)("p",null,"After ",(0,i.kt)("a",{parentName:"p",href:"#unlocking-jenkins"},"unlocking Jenkins"),", the Customize Jenkins page appears. Here we can install any number of\nuseful plugins as part of our initial setup."),(0,i.kt)("p",null,"Click one of the two options shown:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Install suggested plugins")," - to install the recommended set of plugins, which are based on most common use cases."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Select plugins to install")," - to choose which set of plugins to initially install. When we first access the plugin\nselection page, the suggested plugins are selected by default.")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"If we are not sure what plugins we need, choose ",(0,i.kt)("strong",{parentName:"p"},"Install suggested plugins"),". We can install (or remove) additional\nJenkins plugins at a later point in time via the\n",(0,i.kt)("a",{parentName:"p",href:"https://www.jenkins.io/doc/book/managing/"},(0,i.kt)("strong",{parentName:"a"},"Manage Jenkins"))," >\n",(0,i.kt)("a",{parentName:"p",href:"https://www.jenkins.io/doc/book/managing/plugins/"},(0,i.kt)("strong",{parentName:"a"},"Manage Plugins page in Jenkins")),".")),(0,i.kt)("p",null,"The setup wizard shows the progression of Jenkins being configured and our chosen set of Jenkins plugins being\ninstalled. This process may take a few minutes."),(0,i.kt)("h4",{id:"creating-the-first-administrator-user"},"Creating the First Administrator User"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Error loading create-admin-user.png",src:n(1998).Z,width:"1242",height:"784"})),(0,i.kt)("p",null,"Finally, after ",(0,i.kt)("a",{parentName:"p",href:"#customizing-jenkins-with-plugins"},"customizing Jenkins with plugins"),", Jenkins asks us to create our\nfirst administrator user."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"When the ",(0,i.kt)("strong",{parentName:"p"},"Create First Admin User")," page appears, specify the details for our administrator user in the respective\nfields and click ",(0,i.kt)("strong",{parentName:"p"},"Save and Finish"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"When the ",(0,i.kt)("strong",{parentName:"p"},"Jenkins is ready")," page appears, click ",(0,i.kt)("strong",{parentName:"p"},"Start using Jenkins"),"."),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This page may indicate ",(0,i.kt)("strong",{parentName:"li"},"Jenkins is almost ready!")," instead and if so, click ",(0,i.kt)("strong",{parentName:"li"},"Restart"),"."),(0,i.kt)("li",{parentName:"ul"},"If the page does not automatically refresh after a minute, use our web browser to refresh the page manually."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If required, log in to Jenkins with the credentials of the user we just created and we are ready to start using\nJenkins!"))),(0,i.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,i.kt)("h3",{id:"docker-permission-error-when-trigger-by-jenkins"},"Docker Permission Error When Trigger by Jenkins"),(0,i.kt)("p",null,"When a job ",(0,i.kt)("strong",{parentName:"p"},"Build Steps")," contains Shell Execution which includes some Docker command, it might fail with"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'+ docker build ...\nGot permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post "...":\ndial unix /var/run/docker.sock: connect: permission denied\n')),(0,i.kt)("p",null,'The user "jenkins" needs to be added to the group docker:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo usermod -a -G docker jenkins\n")),(0,i.kt)("p",null,"Then restart Jenkins. (and reboot server if not working)"),(0,i.kt)("h3",{id:"echo-off-in-jenkins-console-output"},"Echo Off in Jenkins Console Output"),(0,i.kt)("p",null,"By default, Jenkins launches Execute Shell script with ",(0,i.kt)("inlineCode",{parentName:"p"},"set -x"),". This causes all commands to be echoed. We can type\n",(0,i.kt)("inlineCode",{parentName:"p"},"set +x")," before any command to temporary override that behavior. Of course you will need ",(0,i.kt)("inlineCode",{parentName:"p"},"set -x")," to start showing them\nagain."),(0,i.kt)("p",null,"You can override this behaviour for the whole script by putting the following at the top of the build step:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash +x\n")))}d.isMDXComponent=!0},3442:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,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"},6337:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,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"},2321:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/certbot-requirements-b1ed3b3a8372e888a07e0ccd30164354.png"},1998:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/create-admin-user-ed93c763ea1cd4ba645b1bcebb910f77.png"},6561:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/create-security-group-5ff4ac14e0e8e95d8f682b409efe1cda.png"},7764:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ec2-instance-setup-9605d73972163ced5cc787992326c086.png"},370:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ec2-launch-instance-59738dc47bd4957dba4b4cb53920c468.png"},9981:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ec2-public-dns-c1c6816553a3eb830ceaf3a87ea4ee28.png"},8238:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ec2-service-6ac73bd57369973234f9192c71204b50.png"},7259:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ec2-view-created-instance-334c57b2830177602a82e77a8aeaa38b.png"},9994:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/nginx-directives-30dbdbddf077199d400879319068b9a9.png"},7911:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/self-signed-cert-839b8a47b22e8237992b369b32431aa6.png"},9866:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/trusted-ca-71edbd471ba4499018eae4443dcb696b.png"},6765:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/unlock-jenkins-b0765375d1d16daed87f0938c9e962ab.png"},1495:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/well-known-certificate-authority-040a261c728d656b6b5dea8efa649cc3.png"}}]);