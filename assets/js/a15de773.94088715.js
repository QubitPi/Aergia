"use strict";(self.webpackChunkaergia=self.webpackChunkaergia||[]).push([[6974],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>h});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(r),m=a,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return r?n.createElement(h,i(i({ref:t},u),{},{components:r})):n.createElement(h,i({ref:t},u))}));function h(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},9115:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=r(7462),a=(r(7294),r(3905));const o={slug:"screwdriver",title:"Open Sourcing Screwdriver - Yahoo's Continuous Delivery Build System for Dynamic Infrastructure",authors:["jiaqi"],tags:["CI/CD"]},i=void 0,s={permalink:"/aergia/blog/screwdriver",editUrl:"https://github.com/QubitPi/aergia/tree/gh-pages/blog/2022-06-30-screwdriver/index.md",source:"@site/blog/2022-06-30-screwdriver/index.md",title:"Open Sourcing Screwdriver - Yahoo's Continuous Delivery Build System for Dynamic Infrastructure",description:"[//]: # (Copyright Jiaqi Liu)",date:"2022-06-30T00:00:00.000Z",formattedDate:"June 30, 2022",tags:[{label:"CI/CD",permalink:"/aergia/blog/tags/ci-cd"}],readingTime:4.165,hasTruncateMarker:!0,authors:[{name:"Jiaqi Liu",title:"Maintainer of Aergia",url:"https://github.com/QubitPi",imageURL:"https://avatars.githubusercontent.com/u/16126939?v=4",key:"jiaqi"}],frontMatter:{slug:"screwdriver",title:"Open Sourcing Screwdriver - Yahoo's Continuous Delivery Build System for Dynamic Infrastructure",authors:["jiaqi"],tags:["CI/CD"]},prevItem:{title:"Docker cAdvisor",permalink:"/aergia/blog/docker-c-advisor"},nextItem:{title:"OpenVPN",permalink:"/aergia/blog/openvpn"}},l={authorsImageUrls:[void 0]},c=[],u={toc:c};function d(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Continuous Delivery enables software development teams to move faster and adapt to users' needs quicker by reducing the\ninherent friction associated with releasing software changes. Yahoo's engineering has modernized as it has embraced\nContinuous Delivery as a strategy for improving product quality and engineering agility. All our active products deliver\nfrom commit to production with full automation and this has greatly improved Yahoo's ability to deliver products."),(0,a.kt)("p",null,"Part of what enabled Yahoo to make Continuous Delivery at scale a reality was our improved build and release tooling.\nNow, we are open sourcing an adaptation of our code as ",(0,a.kt)("a",{parentName:"p",href:"http://screwdriver.cd/"},"Screwdriver.cd"),", a new streamlined build\nsystem designed to enable Continuous Delivery to production at scale for dynamic infrastructure."),(0,a.kt)("p",null,"Some of the key design features of Screwdriver have helped Yahoo achieve Continuous Delivery at scale. At a high level\nthese are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Making deployment pipelines easy"),(0,a.kt)("li",{parentName:"ul"},"Optimizing for trunk development"),(0,a.kt)("li",{parentName:"ul"},"Making rolling back easy")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Easy deployment pipelines"),": Deployment pipelines that continuously test, integrate, and deploy code to production\ngreatly reduce the risk of errors and reduce the time to get feedback to developers. The challenge for many groups had\nbeen that pipelines were cumbersome to setup and maintain. We designed a solution that made pipelines easy to configure\nand completely self-service for any developer. By managing the pipeline configuration in the code repository Screwdriver\nallows developers to configure pipelines in a manner familiar to them, and as a bonus, to easily code review pipeline\nchanges too."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Trunk development"),": Internally, we encourage workflows where the trunk is always shippable. Our teams use a modified\n",(0,a.kt)("a",{parentName:"p",href:"https://guides.github.com/introduction/flow/"},"GitHub flow")," for their workflows. Pull Requests (PRs) are the entry point\nfor running tests and ensuring code that entered the repository has been sufficiently tested. Insisting on formal PRs\nalso improves the quality of our code reviews."),(0,a.kt)("p",null,"To ensure trunks are shippable, we enable functional testing of code in the PRs. Internally, this is a configuration\nbaked into pipelines that dynamically allocates compute resources, deploys the code, and runs tests. These tests include\nweb testing using tools like Selenium. These dynamically-allocated resources are also available for a period after the\nPR build, allowing engineers to interact with the system and review visual aspects of their changes."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Easy rollbacks"),': To allow for easy code rollbacks, we allow phases of the pipeline to be re-run at a previously-saved\nstate. We leverage features in our PaaS to handle the deployment, but we store and pass metadata to enable us to re-run\nfrom a specific git SHA with the same deployment data. This allows us to roll back to a previous state in production.\nThis design makes rolling back as easy as selecting a version from a dropdown menu and clicking "deploy". Anyone with\nwrite access to the project can make this change. This helped us move teams to a DevOps model where developers were\nresponsible for the production state.'),(0,a.kt)("p",null,"The successful growth of Screwdriver over the past 5 years at Yahoo has today led to Screwdriver being synonymous with\nContinuous Delivery within the company. ",(0,a.kt)("strong",{parentName:"p"},"Screwdriver handles over 25,000+ builds per day and 12,000+ daily git commits\nas a single shared entrypoint for Yahoo. It supports multiple languages and handles both virtual machine and\ncontainer-based builds and deployment"),"."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Error screwdriver-example.png",src:r(3973).Z,width:"1264",height:"694"})),(0,a.kt)("p",null,"Screwdriver.cd's architecture is comprised of four main components: a frontend for serving content to the user, a\nstateless API that orchestrates between user interactions and build operations, the execution engines (Docker Swarm,\nKubernetes, etc.) that checkout source code and execute in containers, and the launcher that executes and monitors\ncommands inside the container."),(0,a.kt)("p",null,"The diagram below shows this architecture overlaid with a typical developer flow."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Error sd-workflow.png",src:r(7318).Z,width:"1920",height:"900"})),(0,a.kt)("p",null,"To give some context around our execution engines, internal Screwdriver started as an abstraction layer on top of\nJenkins and used Docker to provide isolation, common build containers, etc. We used features provided by Jenkins plugins\nto leverage existing work around coverage and test reports. However, as Screwdriver usage continued to climb, it outgrew\na single Jenkins cluster. So in order to grow to our needs, we added capabilities in Screwdriver that allowed us to\nscale horizontally while also adding capabilities to schedule pipelines across a number of Jenkins clusters. As we\nscaled Screwdriver, we used less from Jenkins and built more supporting services utilizing our cloud infrastructure. The\nopen-source version is focused on Kubernetes and Docker Swarm as our primary supported execution engines."))}d.isMDXComponent=!0},3973:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/screwdriver-example-1ff653cddcc8400a79122dc09a0e65b2.png"},7318:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/sd-workflow-d933e04661ecbdef9646361e5fc60ca6.png"}}]);